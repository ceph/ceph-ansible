---
- name: include installs/install_on_redhat.yml
  include: installs/install_on_redhat.yml
  when:
    - ansible_os_family == 'RedHat'
  tags:
    - package-install
  # Hard code this so we will skip the entire file instead of individual tasks (Default isn't Consistent)
  static: False

- name: include installs/install_on_debian.yml
  include: installs/install_on_debian.yml
  when:
    - ansible_os_family == 'Debian'
  tags:
    - package-install
  # Hard code this so we will skip the entire file instead of individual tasks (Default isn't Consistent)
  static: False

- name: include checks/check_firewall.yml
  include: checks/check_firewall.yml
  when:
    - check_firewall
  # Hard code this so we will skip the entire file instead of individual tasks (Default isn't Consistent)
  static: False

- name: include misc/configure_firewall_rpm.yml
  include: misc/configure_firewall_rpm.yml
  when:
    - configure_firewall
    - ansible_os_family in ['RedHat', 'Suse']
  # Hard code this so we will skip the entire file instead of individual tasks (Default isn't Consistent)
  static: False

- name: include facts_mon_fsid.yml
  include: facts_mon_fsid.yml
  run_once: true
  when:
    - cephx
    - not monitor_keyring_conf.stat.exists
    - ceph_current_fsid.rc == 0
    - mon_group_name in group_names

- name: set_fact docker_exec_cmd
  set_fact:
    docker_exec_cmd: "docker exec ceph-mon-{{ ansible_hostname }}"
  when:
    - containerized_deployment

- name: include deploy_monitors.yml
  include: deploy_monitors.yml
  when: not containerized_deployment

- name: include start_monitor.yml
  include: start_monitor.yml
  when: not containerized_deployment

- name: include ceph_keys.yml
  include: ceph_keys.yml
  when: not containerized_deployment
  # this avoids the bug mentioned here: https://github.com/ansible/ansible/issues/18206
  static: no

- name: include secure_cluster.yml
  include: secure_cluster.yml
  delegate_to: "{{ groups[mon_group_name][0] }}"
  run_once: true
  when:
    - secure_cluster
    - not containerized_deployment

- name: include docker/main.yml
  include: docker/main.yml
  when: containerized_deployment

- name: crush_rules.yml
  include: crush_rules.yml
  when:
    - crush_rule_config

- name: include set_osd_pool_default_pg_num.yml
  include: set_osd_pool_default_pg_num.yml

- name: include calamari.yml
  include: calamari.yml
  when: calamari
