---
- name: manually prepare ceph "{{ osd_objectstore }}" osd disk(s) with collocated osd data and journal
  ceph_disk:
    cluster: "{{ cluster }}"
    objectstore: "{{ osd_objectstore }}"
    data: "{{ item.1 }}"
    dmcrypt: "{{ dmcrypt }}"
    action: prepare
  with_together:
    - "{{ parted_results.results | default([]) }}"
    - "{{ devices }}"
  environment:
    CEPH_CONTAINER_IMAGE: "{{ ceph_docker_registry + '/' + ceph_docker_image + ':' + ceph_docker_image_tag if containerized_deployment | bool else None }}"
  when: item.0.partitions|length == 0
