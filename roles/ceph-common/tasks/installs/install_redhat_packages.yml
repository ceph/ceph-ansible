---
- name: install redhat dependencies
  package:
    name: "{{ redhat_package_dependencies }}"
    state: present
  when:
    - ansible_distribution == 'RedHat'

- name: install centos dependencies
  yum:
    name: "{{ centos_package_dependencies }}"
    state: present
  when:
    - ansible_distribution == 'CentOS'

- name: generate packages to install for redhat
  set_fact:
    _redhat_ceph_pkgs_to_install: [ "ceph-common" ]

- name: add packages to install per host
  set_fact:
    _redhat_ceph_pkgs_to_install: "{{ _redhat_ceph_pkgs_to_install + [ item.name ] }}"
  when: item.install
  with_items:
    - { name: "ceph-test", install: ceph-test }
    - { name: "ceph-mon", install: (mon_group_name in group_names) }
    - { name: "ceph-osd", install: (osd_group_name in group_names) }
    - { name: "ceph-fuse", install: (client_group_name in group_names) }
    - { name: "ceph-base", install: (client_group_name in group_names) }
    - { name: "ceph-radosgw", install: (rgw_group_name in group_names) }

- name: install redhat ceph packages
  package:
    name: "{{ _redhat_ceph_pkgs_to_install }}"
    state: present
