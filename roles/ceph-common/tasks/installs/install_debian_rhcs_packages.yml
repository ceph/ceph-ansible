---
- name: set fact for packages that are always installed
  set_fact:
    _apt_rhcs_pkg_install_list: [ "ceph-common" ]

- name: generate list of packages to install
  set_fact:
    _apt_rhcs_pkg_install_list: "{{ _apt_rhcs_pkg_install_list }} + [ {{ item.pkg_name }} ]"
  when: item.install
  with_items:
    - { pkg_name: "ceph-mon", install: "{{ mon_group_name in group_names }}" }
    - { pkg_name: "ceph-osd", install: "{{ osd_group_name in group_names }}" }
    - { pkg_name: "ceph-test", install: "{{ ceph_test }}" }
    - { pkg_name: "radosgw", install: "{{ rgw_group_name in group_names }}" }
    - { pkg_name: "ceph-fuse", install: "{{ client_group_name in group_names }}" }

- name: install red hat storage ceph packages for debian
  apt:
    pkg: "{{ _apt_rhcs_pkg_install_list }}"
    state: "{{ (upgrade_ceph_packages|bool) | ternary('latest','present') }}"
