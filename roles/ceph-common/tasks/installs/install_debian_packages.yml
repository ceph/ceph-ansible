---
- name: generate packages to install for debian
  set_fact:
    _debian_ceph_pkgs_to_install: [ "ceph", "ceph-common" ]

- name: add packages to install per host
  set_fact:
    _debian_ceph_pkgs_to_install: "{{ _debian_ceph_pkgs_to_install + [ item.name ] }}"
  when: item.install
  with_items:
    - { name: "ceph-test", install: ceph-test }
    - { name: "radosgw", install: (rgw_group_name in group_names) }

- name: install ceph for debian
  apt:
    name: "{{ _debian_ceph_pkgs_to_install }}"
    update_cache: no
    state: "{{ (upgrade_ceph_packages|bool) | ternary('latest','present') }}"
    default_release: "{{ ceph_stable_release_uca | default(omit) }}{{ ansible_distribution_release ~ '-backports' if ceph_origin == 'distro' and ceph_use_distro_backports else ''}}"
