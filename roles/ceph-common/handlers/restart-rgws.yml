---
- name: restart ceph rgws on ubuntu
  command: initctl restart radosgw cluster={{ cluster }} id=rgw.{{ ansible_hostname }}
  when:
    - socketrgw.rc == 0
    - ansible_distribution == 'Ubuntu'
    - not use_systemd
    - rgw_group_name in group_names

- name: restart ceph rgws
  command: /etc/init.d/radosgw restart
  when:
    - socketrgw.rc == 0
    - ansible_distribution != 'Ubuntu'
    - rgw_group_name in group_names
    - is_before_infernalis

- name: restart ceph rgws on red hat
  command: /etc/init.d/ceph-radosgw restart
  when:
    - socketrgw.rc == 0
    - ansible_os_family == 'RedHat'
    - rgw_group_name in group_names
    - is_before_infernalis

- name: restart ceph rgws with systemd
  service:
    name: ceph-rgw@{{ ansible_hostname }}
    state: restarted
  when:
    - socketrgw.rc == 0
    - use_systemd
    - rgw_group_name in group_names
    - is_after_hammer

- name: restart apache2
  service:
    name: apache2
    state: restarted
    enabled: yes
  when:
    - ansible_os_family == 'Debian'
    - rgw_group_name in group_names

- name: restart apache2
  service:
    name: httpd
    state: restarted
    enabled: yes
  when:
    - ansible_os_family == 'RedHat'
    - rgw_group_name in group_names
