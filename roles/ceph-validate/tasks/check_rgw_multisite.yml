---
- name: Fail if rgw_zone is default
  ansible.builtin.fail:
    msg: "rgw_zone cannot be named 'default'"
  loop: "{{ rgw_instances }}"
  when: item.rgw_zone is undefined or item.rgw_zone == 'default'

- name: Fail if either rgw_zonemaster or rgw_zonesecondary is undefined
  ansible.builtin.fail:
    msg: "rgw_zonemaster and rgw_zonesecondary must be defined"
  loop: "{{ rgw_instances }}"
  when: item.rgw_zonemaster | default(rgw_zonemaster) is undefined or item.rgw_zonesecondary | default(rgw_zonesecondary) is undefined

- name: Fail if rgw_zonemaster and rgw_zonesecondary are both true
  ansible.builtin.fail:
    msg: "rgw_zonemaster and rgw_zonesecondary cannot both be true"
  loop: "{{ rgw_instances }}"
  when:
    - item.rgw_zonemaster | default(rgw_zonemaster) | bool
    - item.rgw_zonesecondary | default(rgw_zonesecondary) | bool

- name: Fail if rgw_zonegroup is not set
  ansible.builtin.fail:
    msg: "rgw_zonegroup has not been set by the user"
  loop: "{{ rgw_instances }}"
  when: item.rgw_zonegroup is undefined

- name: Fail if rgw_zone_user is not set
  ansible.builtin.fail:
    msg: "rgw_zone_user has not been set by the user"
  loop: "{{ rgw_instances }}"
  when: item.rgw_zone_user is undefined

- name: Fail if rgw_zone_user_display_name is not set
  ansible.builtin.fail:
    msg: "rgw_zone_user_display_name has not been set by the user"
  loop: "{{ rgw_instances }}"
  when: item.rgw_zone_user_display_name is undefined

- name: Fail if rgw_realm is not set
  ansible.builtin.fail:
    msg: "rgw_realm has not been set by the user"
  loop: "{{ rgw_instances }}"
  when: item.rgw_realm is undefined

- name: Fail if system_access_key is not set
  ansible.builtin.fail:
    msg: "system_access_key has not been set by the user"
  loop: "{{ rgw_instances }}"
  when: item.system_access_key is undefined

- name: Fail if system_secret_key is not set
  ansible.builtin.fail:
    msg: "system_secret_key has not been set by the user"
  loop: "{{ rgw_instances }}"
  when: item.system_secret_key is undefined

- name: Fail if endpoint is not set
  ansible.builtin.fail:
    msg: "endpoint has not been set by the user"
  loop: "{{ rgw_instances }}"
  when:
    - item.rgw_zonesecondary | default(rgw_zonesecondary) | bool
    - rgw_pull_port is undefined and rgw_pullhost is undefined and item.rgw_pull_proto | default(rgw_pull_proto) is undefined
    - item.endpoint is undefined
